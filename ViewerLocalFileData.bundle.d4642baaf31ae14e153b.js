(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1e3:function(e,t){},1027:function(e,t,n){},948:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(84),a=n(134),s=n(975),u=n(1),c=n.n(u),l=n(256),p=n(1043),f=n(992),d=(n(1027),n(33));function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var I=o.a.OHIFStudyMetadata,O=a.a.studyMetadataManager,D=function(e,t,n){return i.a.createElement(p.a,{onDrop:e,noDrag:!0},(function(e){var r=e.getRootProps,o=e.getInputProps;return i.a.createElement("span",w({},r(),{className:"link-dialog"}),n?i.a.createElement("span",null,t("Load folders"),i.a.createElement("input",w({},o(),{webkitdirectory:"true",mozdirectory:"true"}))):i.a.createElement("span",null,t("Load files"),i.a.createElement("input",o())))}))},P=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return r=this,i=(e=h(t)).call.apply(e,[this].concat(a)),n=!i||"object"!==y(i)&&"function"!=typeof i?b(r):i,S(b(n),"state",{studies:null,loading:!1,error:null}),S(b(n),"updateStudies",(function(e){O.purge();var t=e.map((function(e){var t=new I(e,e.StudyInstanceUID),n=l.c.modules.sopClassHandlerModule;return e.displaySets=e.displaySets||t.createDisplaySets(n),t.forEachDisplaySet((function(e){e.localFile=!0})),O.add(t),e}));n.setState({studies:t})})),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.next=3,Object(f.a)(n);case 3:if(r=t.sent,i=e.updateStudies(r)){t.next=7;break}return t.abrupt("return");case 7:e.setState({studies:i,loading:!1});case 8:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){m(o,r,i,a,s,"next",e)}function s(e){m(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e){return n.apply(this,arguments)}}();return this.state.error?i.a.createElement("div",null,"Error: ",JSON.stringify(this.state.error)):i.a.createElement(p.a,{onDrop:t,noClick:!0},(function(n){var r=n.getRootProps;return n.getInputProps,i.a.createElement("div",w({},r(),{style:{width:"100%",height:"100%"}}),e.state.studies?i.a.createElement(s.a,{studies:e.state.studies,studyInstanceUIDs:e.state.studies&&e.state.studies.map((function(e){return e.StudyInstanceUID}))}):i.a.createElement("div",{className:"drag-drop-instructions"},i.a.createElement("div",{className:"drag-drop-contents"},e.state.loading?i.a.createElement("h3",null,e.props.t("Loading...")):i.a.createElement(i.a.Fragment,null,i.a.createElement("h3",null,e.props.t("Drag and Drop DICOM files here to load them in the Viewer")),i.a.createElement("h4",null,function(e,t){return i.a.createElement(i.a.Fragment,null,t("Or click to "),D(e,t),t(" or "),D(e,t,!0),t(" from dialog"))}(t,e.props.t))))))}))}}])&&v(n.prototype,r),o&&v(n,o),t}(r.Component);S(P,"propTypes",{studies:c.a.array}),t.default=Object(d.d)("Common")(P)},975:function(e,t,n){"use strict";var r,i,o,a,s=n(58),u=n(0),c=n.n(u),l=n(1),p=n.n(l),f=n(17),d=n.n(f),y=n(16),m=n(245),v=n(564),h=n(15),b=n(6),g=n.n(b),S=n(991),w=n(33),I=(n(976),n(256)),O=n(7),D=n.n(O),P=n(36),E=n.n(P),j=(0,D.a.import)("util/scrollToIndex"),x=y.a.redux.actions.setViewportSpecificData,C=Object(s.b)((function(e){var t=e.viewports,n=(t.viewportSpecificData[t.activeViewportIndex]||{}).cine;return{activeEnabledElement:I.a.runCommand("getActiveViewportEnabledElement"),activeViewportCineData:n||{isPlaying:!1,cineFrameRate:24},activeViewportIndex:e.viewports.activeViewportIndex}}),(function(e){return{dispatchSetViewportSpecificData:function(t,n){e(x(t,n))}}}),(function(e,t,n){var r=e.activeEnabledElement,i=e.activeViewportCineData,o=e.activeViewportIndex;return{cineFrameRate:i.cineFrameRate,isPlaying:i.isPlaying,onPlayPauseChanged:function(e){var n=E()(i);n.isPlaying=!n.isPlaying,t.dispatchSetViewportSpecificData(o,{cine:n})},onFrameRateChanged:function(e){var n=E()(i);n.cineFrameRate=e,t.dispatchSetViewportSpecificData(o,{cine:n})},onClickNextButton:function(){var e=D.a.getToolState(r,"stack");if(e&&e.data&&e.data.length){var t=e.data[0],n=t.currentImageIdIndex;n>=t.imageIds.length-1||j(r,n+1)}},onClickBackButton:function(){var e=D.a.getToolState(r,"stack");if(e&&e.data&&e.data.length){var t=e.data[0].currentImageIdIndex;0!==t&&j(r,t-1)}},onClickSkipToStart:function(){var e=D.a.getToolState(r,"stack");e&&e.data&&e.data.length&&j(r,0)},onClickSkipToEnd:function(){var e=D.a.getToolState(r,"stack");if(e&&e.data&&e.data.length){var t=e.data[0].imageIds.length-1;j(r,t)}}}}))(h.c),k=y.a.redux.actions,R=k.setLayout,T=k.setViewportActive,_=Object(s.b)((function(e){return{currentLayout:e.viewports.layout,activeViewportIndex:e.viewports.activeViewportIndex}}),(function(e){return{onChange:function(t,n,r){for(var i=[],o=t.row+1,a=t.col+1,s=o*a,u=0;u<s;u++){var c=n.viewports[u],l=c&&c.plugin;c&&c.vtk&&(l="cornerstone"),i.push({plugin:l})}var p={numRows:o,numColumns:a,viewports:i};r>s-1&&e(T(0)),e(R(p))}}}),(function(e,t){var n=t.onChange,r=e.currentLayout,i=e.activeViewportIndex;return{onChange:function(e){return n(e,r,i)}}}))(h.k);function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(i=V(t).call(this,e))||"object"!==U(i)&&"function"!=typeof i?A(r):i).state={},n.handleClick=n.handleClick.bind(A(n)),n}var n,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,e),n=t,(s=[{key:"handleClick",value:function(){var e=window.location.href.toString();alert(e);var t=e.split("/");alert(t[4]);var n=document.getElementsByClassName("top-left overlay-element")[0].innerHTML,s=n.slice(0,n.lastIndexOf("<div>"));r=s.slice(5,s.lastIndexOf("</div>")),alert(r),i=n.slice(n.lastIndexOf("<div>")+5,n.lastIndexOf("</div>")),alert(i);var u=document.getElementsByClassName("top-right overlay-element")[0].innerHTML,c=u.slice(0,u.lastIndexOf("<div>"));o=c.slice(5,c.lastIndexOf("</div>")),alert(o),a=u.slice(u.lastIndexOf("<div>")+5,u.lastIndexOf("</div>")),alert(a),window.location.replace("https://atiya1-hub.github.io/#/studydet/".concat(r,"&").concat(o,"&").concat(i,"&").concat(a,"&").concat(t[4]))}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){return e.handleClick()}},"share"))}}])&&N(n.prototype,s),u&&N(n,u),t}(u.Component),q=n(90);function B(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=function(e){function t(e){var n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=H(t).call(this,e),n=!i||"object"!==F(i)&&"function"!=typeof i?J(r):i,Y(J(n),"closeCineDialogIfNotApplicable",(function(){var e=n.props.dialog,t=n.state,r=t.dialogId,i=t.activeButtons,o=t.toolbarButtons;r&&(o.find((function(e){return e.options&&"CINE"===e.options.behavior}))||(e.dismiss({id:r}),i=i.filter((function(e){return e.options&&"CINE"!==e.options.behavior})),n.setState({dialogId:null,activeButtons:i})))}));var o=ee.call(J(n));return n.state={toolbarButtons:o,activeButtons:[]},n.seriesPerStudyCount=[],n._handleBuiltIn=te.bind(J(n)),n.updateButtonGroups(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,e),n=t,(r=[{key:"updateButtonGroups",value:function(){var e=this,t=I.c.modules[v.a.PANEL];this.buttonGroups={left:[],right:[]},t.forEach((function(t){var n=t.module,r=Array.from(n.defaultContext);n.menuOptions.forEach((function(t){var n=Array.from(t.context||r),i=e.props.activeContexts.some((function(e){return n.includes(e)})),o="function"==typeof t.isDisabled&&t.isDisabled(e.props.studies);if(i&&!o){var a={value:t.target,icon:t.icon,bottomLabel:t.label},s=t.from||"right";e.buttonGroups[s].push(a)}}))})),this.buttonGroups.left.unshift({value:"studies",icon:"th-large",bottomLabel:this.props.t("Series")})}},{key:"componentDidUpdate",value:function(e){var t=e.activeContexts!==this.props.activeContexts,n=e.studies,r=this.props.studies,i=this.seriesPerStudyCount,o=!1;if(n.length!==r.length)o=!0;else for(var a=0;a<r.length;a++)if(r[a].series.length!==i[a]){i[a]=r[a].series.length,o=!0;break}o&&this.updateButtonGroups(),t&&this.setState({toolbarButtons:ee.call(this)},this.closeCineDialogIfNotApplicable)}},{key:"render",value:function(){var e=this,t=Z.call(this,this.state.toolbarButtons,this.state.activeButtons),n=function(t,n){e.props.handleSidePanelChange(t,n)},r=n.bind(this,"left"),i=n.bind(this,"right");return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,c.a.createElement("h1",null,"Study")),c.a.createElement("div",{className:"ToolbarRow"},c.a.createElement("div",{className:"pull-left m-t-1 p-y-1",style:{padding:"10px"}},c.a.createElement(h.s,{options:this.buttonGroups.left,value:this.props.selectedLeftSidePanel||"",onValueChanged:r})),t,c.a.createElement(_,null),c.a.createElement(L,null),c.a.createElement("div",{className:"pull-right m-t-1 rm-x-1",style:{marginLeft:"auto"}},this.buttonGroups.right.length&&c.a.createElement(h.s,{options:this.buttonGroups.right,value:this.props.selectedRightSidePanel||"",onValueChanged:i}))))}}])&&G(n.prototype,r),i&&G(n,i),t}(u.Component);function Q(e,t){var n=e.CustomComponent;if("function"==typeof n){var r=t.map((function(e){return e.id})),i=r.includes(e.id);return c.a.createElement(n,{parentContext:this,toolbarClickCallback:$.bind(this),button:e,key:e.id,activeButtons:r,isActive:i})}}function K(e,t){var n,r=this,i=e.buttons.map((function(e){return e.onClick=$.bind(r,e),t.map((function(e){return e.id})).indexOf(e.id)>-1&&(n=e.id),e}));return c.a.createElement(h.g,{key:e.id,label:e.label,icon:e.icon,buttons:i,activeCommand:n})}function X(e,t){return c.a.createElement(h.G,{key:e.id,label:e.label,icon:e.icon,onClick:$.bind(this,e),isActive:t.map((function(e){return e.id})).includes(e.id)})}function Z(e,t){var n=this;return e.map((function(e){var r=e.CustomComponent,i=e.buttons&&e.buttons.length;return r?Q.call(n,e,t):i?K.call(n,e,t):X.call(n,e,t)}))}function $(e,t,n){var r=this.state.activeButtons;if(e.commandName){var i=Object.assign({evt:t},e.commandOptions);I.a.runCommand(e.commandName,i)}if("setToolActive"===e.type){var o=r.filter((function(e){var t=e.options;return t&&!t.togglable}));this.setState({activeButtons:[].concat(B(o),[e])})}else"builtIn"===e.type&&this._handleBuiltIn(e)}function ee(){var e=this,t=I.c.modules[v.a.TOOLBAR],n=[];return t.forEach((function(t){var r=t.module,i=r.definitions,o=r.defaultContext;i.forEach((function(t){var r=t.context||o;e.props.activeContexts.includes(r)&&n.push(t)}))})),n}function te(e){var t=this.props,n=t.dialog,r=t.t,i=this.state.dialogId,o=e.id,a=e.options;if("CINE"===a.behavior)if(i)n.dismiss({id:i}),this.setState((function(e){return{dialogId:null,activeButtons:B(e.activeButtons.filter((function(e){return e.id!==o})))}}));else{var s=document.querySelector(".ViewerMain").getBoundingClientRect(),u=s.x,c=s.y,l=n.create({content:C,defaultPosition:{x:u+20||0,y:c+20||0}});this.setState((function(t){return{dialogId:l,activeButtons:[].concat(B(t.activeButtons),[e])}}))}"DOWNLOAD_SCREEN_SHOT"===a.behavior&&I.a.runCommand("showDownloadViewportModal",{title:r("Download High Quality Image")})}Y(z,"propTypes",{isLeftSidePanelOpen:p.a.bool.isRequired,isRightSidePanelOpen:p.a.bool.isRequired,selectedLeftSidePanel:p.a.string.isRequired,selectedRightSidePanel:p.a.string.isRequired,handleSidePanelChange:p.a.func.isRequired,activeContexts:p.a.arrayOf(p.a.string).isRequired,studies:p.a.array,t:p.a.func.isRequired,dialog:p.a.any,modal:p.a.any}),Y(z,"defaultProps",{studies:[]});var ne=Object(w.d)(["Common","ViewportDownloadForm"])(Object(h.O)(Object(h.N)(Object(q.e)(z))));y.a.utils.studyMetadataManager;var re=y.a.redux.actions.setActiveViewportSpecificData,ie=Object(s.b)((function(e,t){var n=e.loading.progress,r=E()(t.studies);return r.forEach((function(e){e.thumbnails.forEach((function(e){var t=e.displaySetInstanceUID,r="StackProgress:".concat(t),i=n[r],o=0;i&&(o=i.percentComplete),e.stackPercentComplete=o}))})),{studies:r}}),(function(e,t){return{onThumbnailClick:function(n){var r=function(e,t){return Array.isArray(e)&&e.reduce((function(e,t){var n=[];return t&&Array.isArray(t.displaySets)&&(n=t.displaySets),e.concat(n)}),[]).find((function(e){return e.displaySetInstanceUID===t}))||null}(t.studyMetadata,n);if(r.isDerived){var i=r.Modality;if(!(r=r.getSourceDisplaySet(t.studyMetadata)))throw new Error("Referenced series for ".concat(i," dataset not present."));if(!r)throw new Error("Source data not present")}e(re(r))}}}))(h.y),oe=(n(977),n(978),n(134)),ae=n(193);n(979);function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ue=function(e){var t=e.children,n=e.onDrop,r=e.viewportIndex,i=e.className,o=se(Object(ae.d)({accept:"thumbnail",drop:function(e,t){var i=t.canDrop(),o=t.isOver();if(i&&o&&n){var a=e.StudyInstanceUID,s=e.displaySetInstanceUID;n({viewportIndex:r,StudyInstanceUID:a,displaySetInstanceUID:s})}},collect:function(e){return{highlighted:e.canDrop(),hovered:e.isOver()}}}),2),a=o[0],s=a.hovered,u=a.highlighted,l=o[1];return c.a.createElement("div",{className:d()("viewport-drop-target",{hovered:s},{highlighted:u},i),ref:l,"data-cy":"viewport-container-".concat(r)},t)};ue.propTypes={children:p.a.node.isRequired,viewportIndex:p.a.number.isRequired,onDrop:p.a.func.isRequired,className:p.a.string};var ce=ue;var le=n(980),pe=n.n(le),fe=oe.a.loadAndCacheDerivedDisplaySets,de=function(e){var t=e.activeViewportIndex,n=e.availablePlugins,r=e.defaultPlugin,i=e.layout,o=e.numRows,a=e.numColumns,s=e.setViewportData,l=e.studies,p=e.viewportData,f=e.children,y=e.isStudyLoaded,m=100/o,v=100/a;if(!p||!p.length)return null;var b=Object(h.M)();Object(u.useEffect)((function(){y&&p.forEach((function(e){fe(e,l).forEach((function(e){e.catch((function(e){b.show({title:"Error loading derived display set:",message:e.message,type:"error",autoClose:!1})}))}))}))}),[l,p,y,b]);var g=c.a.useMemo((function(){return i.viewports.map((function(e,i){var o=p[i];if(!o)return null;var a={displaySet:o,studies:l},u=!e.plugin&&o&&o.plugin?o.plugin:e.plugin,y=function(e,t,n,r,i,o){if(e.displaySet){var a=r[i=i||o];if(!a)throw new Error("No Viewport Component available for name ".concat(i,".\n         Available plugins: ").concat(JSON.stringify(r)));return c.a.createElement(a,{viewportData:e,viewportIndex:t,children:[n]})}return c.a.createElement(pe.a,null)}(a,i,f,n,u,r);return c.a.createElement(ce,{onDrop:s,viewportIndex:i,className:d()("viewport-container",{active:t===i}),key:i},y)}))}),[i,p,l,f,n,r,s,t]);return c.a.createElement("div",{"data-cy":"viewprt-grid",style:{display:"grid",gridTemplateRows:"repeat(".concat(o,", ").concat(m,"%)"),gridTemplateColumns:"repeat(".concat(a,", ").concat(v,"%)"),height:"100%",width:"100%"}},g)};de.propTypes={viewportData:p.a.array.isRequired,supportsDrop:p.a.bool.isRequired,activeViewportIndex:p.a.number.isRequired,layout:p.a.object.isRequired,availablePlugins:p.a.object.isRequired,setViewportData:p.a.func.isRequired,studies:p.a.array,children:p.a.node,defaultPlugin:p.a.string,numRows:p.a.number.isRequired,numColumns:p.a.number.isRequired},de.defaultProps={viewportData:[],numRows:1,numColumns:1,layout:{viewports:[{}]},activeViewportIndex:0,supportsDrop:!0,availablePlugins:{DefaultViewport:function(e){return React.createElement("div",null,JSON.stringify(e))}},defaultPlugin:"defaultViewportPlugin"};var ye=de,me=n(588),ve=n.n(me),he=ve()((function(e){var t={};return e.forEach((function(e){t[e.extensionId]=e.module})),t})),be=Object(s.b)((function(e){var t,n=I.c.modules[v.a.VIEWPORT],r=he(n);n.length&&(t=n[0].extensionId);var i=e.viewports;return{numRows:i.numRows,numColumns:i.numColumns,layout:i.layout,activeViewportIndex:i.activeViewportIndex,availablePlugins:r,defaultPlugin:t}}),null)(ye),ge=n(994),Se=n.n(ge);function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function De(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var je=ve()(Se.a),xe=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=Oe(t).call(this,e),n=!i||"object"!==we(i)&&"function"!=typeof i?De(r):i,Ee(De(n),"fillEmptyViewportPanes",(function(){var e=[],t=n.props,r=t.layout,i=t.viewportSpecificData,o=n.state.displaySets;if(o&&o.length){for(var a=0;a<r.viewports.length;a++){var s=i[a];if(s&&s.StudyInstanceUID&&s.displaySetInstanceUID)e.push({StudyInstanceUID:s.StudyInstanceUID,displaySetInstanceUID:s.displaySetInstanceUID});else{var u=o.find((function(t){return!e.some((function(e){return e.displaySetInstanceUID===t.displaySetInstanceUID}))}))||o[o.length-1];e.push(u)}}e.forEach((function(e,t){e&&e.StudyInstanceUID&&n.setViewportData({viewportIndex:t,StudyInstanceUID:e.StudyInstanceUID,displaySetInstanceUID:e.displaySetInstanceUID})}))}})),Ee(De(n),"setViewportData",(function(e){var t=e.viewportIndex,r=e.StudyInstanceUID,i=e.displaySetInstanceUID,o=n.findDisplaySet(n.props.studies,r,i);if(o.isDerived){var a=o.Modality;if(!(o=o.getSourceDisplaySet(n.props.studies)))throw new Error("Referenced series for ".concat(a," dataset not present."))}n.props.setViewportSpecificData(t,o)})),n.state={displaySets:[]},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(t,e),n=t,(r=[{key:"getDisplaySets",value:function(e){var t=[];return e.forEach((function(e){e.displaySets.forEach((function(e){e.plugin||(e.plugin="cornerstone"),t.push(e)}))})),t}},{key:"findDisplaySet",value:function(e,t,n){var r=e.find((function(e){return e.StudyInstanceUID===t}));if(r)return r.displaySets.find((function(e){return e.displaySetInstanceUID===n}))}},{key:"componentDidMount",value:function(){if(this.props.studies){var e=this.getDisplaySets(this.props.studies);this.setState({displaySets:e},this.fillEmptyViewportPanes)}}},{key:"componentDidUpdate",value:function(e){var t=e.layout.viewports.length,n=this.props.layout.viewports.length,r=this.props.layout.viewports.some((function(e){return!!e.vtk}));if(this.props.studies!==e.studies||n!==t&&!r){var i=this.getDisplaySets(this.props.studies);this.setState({displaySets:i},this.fillEmptyViewportPanes)}}},{key:"render",value:function(){var e=this.props.viewportSpecificData,t=je(e);return c.a.createElement("div",{className:"ViewerMain"},this.state.displaySets.length&&c.a.createElement(be,{isStudyLoaded:this.props.isStudyLoaded,studies:this.props.studies,viewportData:t,setViewportData:this.setViewportData}))}},{key:"componentWillUnmount",value:function(){var e=this,t=this.props.viewportSpecificData;Object.keys(t).forEach((function(t){e.props.clearViewportSpecificData(t)}))}}])&&Ie(n.prototype,r),i&&Ie(n,i),t}(u.Component);Ee(xe,"propTypes",{activeViewportIndex:p.a.number.isRequired,studies:p.a.array,viewportSpecificData:p.a.object.isRequired,layout:p.a.object.isRequired,setViewportSpecificData:p.a.func.isRequired,clearViewportSpecificData:p.a.func.isRequired});var Ce=xe,ke=y.a.redux.actions,Re=ke.setViewportSpecificData,Te=ke.clearViewportSpecificData,_e=Object(s.b)((function(e){var t=e.viewports;return{activeViewportIndex:t.activeViewportIndex,layout:t.layout,viewportSpecificData:t.viewportSpecificData,viewports:e.viewports}}),(function(e){return{setViewportSpecificData:function(t,n){e(Re(t,n))},clearViewportSpecificData:function(){e(Te())}}}))(Ce);n(981);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ve(e,t){return!t||"object"!==Ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Le,qe,Be,Fe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ve(this,Ae(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e="right"===this.props.from?"from-right":"from-left",t=this.props.width?{maxWidth:this.props.width,marginRight:this.props.isOpen?"0":-1*Number.parseInt(this.props.width)}:{};return c.a.createElement("section",{style:t,className:d()("sidepanel",e,{"is-open":this.props.isOpen})},this.props.children)}}])&&Ne(n.prototype,r),i&&Ne(n,i),t}(u.Component);Le=Fe,qe="propTypes",Be={from:p.a.string.isRequired,isOpen:p.a.bool.isRequired,children:p.a.node,width:p.a.string},qe in Le?Object.defineProperty(Le,qe,{value:Be,enumerable:!0,configurable:!0,writable:!0}):Le[qe]=Be;var Ge=Fe;n(982);function He(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Je=I.e.services.UIModalService,We=function(e){var t=e.context,n=e.children;return c.a.createElement(h.f,{fallbackComponent:function(){return c.a.createElement("div",{className:"ErrorFallback",role:"alert"},c.a.createElement("p",null,"Error rendering ",t,". ",c.a.createElement("br",null)," Check the browser console for more details."))},context:t,onError:function(e,n){Je.show({content:function(){var r=He(Object(u.useState)(!1),2),i=r[0],o=r[1];return c.a.createElement("div",{className:"ErrorFallback",role:"alert"},c.a.createElement("div",{className:"ErrorBoundaryDialog"},c.a.createElement("h3",{className:"ErrorBoundaryDialogTitle"},t,": ",c.a.createElement("span",null,e.message))),c.a.createElement("button",{className:"btn btn-primary btn-sm ErrorBoundaryDialogButton",onClick:function(){return o((function(e){return!e}))}},c.a.createElement(h.i,{name:"chevron-down",className:d()("ErrorBoundaryDialogIcon",{opened:i})}),"Stack Trace"),i&&c.a.createElement("pre",null,n))},title:"Something went wrong in ".concat(t)})}},n)};We.propTypes={context:p.a.string.isRequired,children:p.a.node.isRequired};var Ye=We,ze=n(211),Qe=n(257);n(983),n(995);function Ke(e){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=function(e){function t(e){var n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=Ze(t).call(this,e),n=!i||"object"!==Ke(i)&&"function"!=typeof i?$e(r):i,tt($e(n),"state",{isLeftSidePanelOpen:!0,isRightSidePanelOpen:!1,selectedRightSidePanel:"",selectedLeftSidePanel:"studies",thumbnails:[]}),tt($e(n),"retrieveTimepoints",(function(e){y.a.log.info("retrieveTimepoints");var t=(new Date).toISOString(),r=(new Date).toISOString();return n.props.studies&&(r=new Date("1000-01-01").toISOString(),n.props.studies.forEach((function(e){var n=g()(e.StudyDate,"YYYYMMDD").toISOString();n<t&&(t=n),n>r&&(r=n)}))),Promise.resolve([{timepointType:"baseline",timepointId:"TimepointId",studyInstanceUIDs:n.props.studyInstanceUIDs,PatientID:e.PatientID,earliestDate:t,latestDate:r,isLocked:!1}])})),tt($e(n),"storeTimepoints",(function(e){return y.a.log.info("storeTimepoints"),Promise.resolve()})),tt($e(n),"updateTimepoint",(function(e,t){return y.a.log.info("updateTimepoint"),Promise.resolve()})),tt($e(n),"removeTimepoint",(function(e){return y.a.log.info("removeTimepoint"),Promise.resolve()})),tt($e(n),"disassociateStudy",(function(e,t){return y.a.log.info("disassociateStudy"),Promise.resolve()})),tt($e(n),"onTimepointsUpdated",(function(e){n.props.onTimepointsUpdated&&n.props.onTimepointsUpdated(e)})),tt($e(n),"onMeasurementsUpdated",(function(e){n.props.onMeasurementsUpdated&&n.props.onMeasurementsUpdated(e)}));var o=n.props.activeServer,a=Object.assign({},o);return y.a.measurements.MeasurementApi.setConfiguration({dataExchange:{retrieve:m.a.retrieveMeasurements,store:m.a.storeMeasurements},server:a}),y.a.measurements.TimepointApi.setConfiguration({dataExchange:{retrieve:n.retrieveTimepoints,store:n.storeTimepoints,remove:n.removeTimepoint,update:n.updateTimepoint,disassociate:n.disassociateStudy}}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,e),n=t,(r=[{key:"componentWillUnmount",value:function(){this.props.dialog&&this.props.dialog.dismissAll()}},{key:"componentDidMount",value:function(){var e=this.props,t=e.studies,n=e.isStudyLoaded,r=y.a.measurements,i=r.TimepointApi,o=r.MeasurementApi,a=new i("TimepointId",{onTimepointsUpdated:this.onTimepointsUpdated}),s=new o(a,{onMeasurementsUpdated:this.onMeasurementsUpdated});if(this.currentTimepointId="TimepointId",this.timepointApi=a,this.measurementApi=s,t){var u=t[0]&&t[0].PatientID;a.retrieveTimepoints({PatientID:u}),n&&this.measurementApi.retrieveMeasurements(u,["TimepointId"]),this.setState({thumbnails:it(t)})}}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.studies,r=t.isStudyLoaded;if(n!==e.studies&&this.setState({thumbnails:it(n)}),r&&r!==e.isStudyLoaded){var i=n[0]&&n[0].PatientID,o=this.currentTimepointId;this.timepointApi.retrieveTimepoints({PatientID:i}),this.measurementApi.retrieveMeasurements(i,[o])}}},{key:"render",value:function(){var e,t,n=this;return I.c.modules[v.a.PANEL].forEach((function(r){r.module.components.forEach((function(r){r.id===n.state.selectedRightSidePanel?t=r.component:r.id===n.state.selectedLeftSidePanel&&(e=r.component)}))})),c.a.createElement(c.a.Fragment,null,c.a.createElement(ze.a.Consumer,null,(function(e){return c.a.createElement(Qe.a.Consumer,null,(function(t){return c.a.createElement(q.c.Consumer,null,(function(n){return c.a.createElement(S.a,{linkText:n.appConfig.showStudyList?"Study List":void 0,linkPath:n.appConfig.showStudyList?"/":void 0,userManager:t},e&&e.createLogoComponentFn&&e.createLogoComponentFn(c.a))}))}))})),c.a.createElement(Ye,{context:"ToolbarRow"},c.a.createElement(ne,{isLeftSidePanelOpen:this.state.isLeftSidePanelOpen,isRightSidePanelOpen:this.state.isRightSidePanelOpen,selectedLeftSidePanel:this.state.isLeftSidePanelOpen?this.state.selectedLeftSidePanel:"",selectedRightSidePanel:this.state.isRightSidePanelOpen?this.state.selectedRightSidePanel:"",handleSidePanelChange:function(e,t){var r=e&&e[0].toUpperCase()+e.slice(1),i="is".concat(r,"SidePanelOpen"),o="selected".concat(r,"SidePanel"),a=Object.assign({},n.state),s=a[i],u=a[o],c=u===t||null===t;a[o]=t||u,(!s||c)&&(a[i]=!a[i]),n.setState(a)},studies:this.props.studies})),c.a.createElement("div",{className:"FlexboxLayout"},c.a.createElement(Ye,{context:"LeftSidePanel"},c.a.createElement(Ge,{from:"left",isOpen:this.state.isLeftSidePanelOpen},e?c.a.createElement(e,{viewports:this.props.viewports,studies:this.props.studies,activeIndex:this.props.activeViewportIndex}):c.a.createElement(ie,{studies:this.state.thumbnails,studyMetadata:this.props.studies}))),c.a.createElement("div",{className:d()("main-content")},c.a.createElement(Ye,{context:"ViewerMain"},c.a.createElement(_e,{studies:this.props.studies,isStudyLoaded:this.props.isStudyLoaded}))),c.a.createElement(Ye,{context:"RightSidePanel"},c.a.createElement(Ge,{from:"right",isOpen:this.state.isRightSidePanelOpen},t&&c.a.createElement(t,{isOpen:this.state.isRightSidePanelOpen,viewports:this.props.viewports,studies:this.props.studies,activeIndex:this.props.activeViewportIndex})))))}}])&&Xe(n.prototype,r),i&&Xe(n,i),t}(u.Component);tt(nt,"propTypes",{studies:p.a.arrayOf(p.a.shape({StudyInstanceUID:p.a.string.isRequired,StudyDate:p.a.string,PatientID:p.a.string,displaySets:p.a.arrayOf(p.a.shape({displaySetInstanceUID:p.a.string.isRequired,SeriesDescription:p.a.string,SeriesNumber:p.a.number,InstanceNumber:p.a.number,numImageFrames:p.a.number,Modality:p.a.string.isRequired,images:p.a.arrayOf(p.a.shape({getImageId:p.a.func.isRequired}))}))})),studyInstanceUIDs:p.a.array,activeServer:p.a.shape({type:p.a.string,wadoRoot:p.a.string}),onTimepointsUpdated:p.a.func,onMeasurementsUpdated:p.a.func,viewports:p.a.object.isRequired,activeViewportIndex:p.a.number.isRequired,isStudyLoaded:p.a.bool,dialog:p.a.object});var rt=Object(h.N)(nt),it=function(e){return e.map((function(e){return{StudyInstanceUID:e.StudyInstanceUID,thumbnails:e.displaySets.map((function(e){var t,n,r=e.displaySetInstanceUID,i=e.SeriesDescription,o=e.InstanceNumber,a=e.numImageFrames,s=e.SeriesNumber;if(e.Modality&&"SEG"===e.Modality)n="SEG";else if(e.images&&e.images.length){var u=Math.floor(e.images.length/2);t=e.images[u].getImageId()}else n=e.Modality?e.Modality:"UN";return{imageId:t,altImageText:n,displaySetInstanceUID:r,SeriesDescription:i,InstanceNumber:o,numImageFrames:a,SeriesNumber:s}}))}}))},ot=y.a.redux.actions,at=ot.setTimepoints,st=ot.setMeasurements,ut=function(e){return e.servers.find((function(e){return!0===e.active}))},ct=Object(s.b)((function(e){var t=e.viewports,n=e.servers;return{viewports:t.viewportSpecificData,activeViewportIndex:t.activeViewportIndex,activeServer:ut(n)}}),(function(e){return{onTimepointsUpdated:function(t){e(at(t))},onMeasurementsUpdated:function(t){e(st(t))}}}))(rt);t.a=ct},976:function(e,t,n){},977:function(e,t,n){},978:function(e,t,n){},979:function(e,t,n){},980:function(e,t){},981:function(e,t,n){},982:function(e,t,n){},983:function(e,t,n){},992:function(e,t,n){"use strict";var r=n(55),i=n.n(r);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=void 0,(n="fileType")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}var t,n,r;return t=e,(n=[{key:"loadFile",value:function(e,t){}},{key:"getDataset",value:function(e,t){}},{key:"getStudies",value:function(e,t){}}])&&o(t.prototype,n),r&&o(t,r),e}();function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=new(function(e){function t(){var e,n,r,i,o,a,u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var p=arguments.length,f=new Array(p),d=0;d<p;d++)f[d]=arguments[d];return r=this,n=!(i=(e=c(t)).call.apply(e,[this].concat(f)))||"object"!==s(i)&&"function"!=typeof i?l(r):i,o=l(n),u="application/pdf",(a="fileType")in o?Object.defineProperty(o,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[a]=u,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,e),n=t,(r=[{key:"loadFile",value:function(e,t){return i.a.wadouri.loadFileRequest(t)}},{key:"getDataset",value:function(e,t){var n={};return n.imageId=e.imageId||t,n}},{key:"getStudies",value:function(e,t){return this.getDefaultStudy(t)}},{key:"getDefaultStudy",value:function(e){return{StudyInstanceUID:"",StudyDate:"",StudyTime:"",AccessionNumber:"",ReferringPhysicianName:"",PatientName:"",PatientID:"",PatientBirthdate:"",PatientSex:"",StudyId:"",StudyDescription:"",series:[{SeriesInstanceUID:"",SeriesDescription:"",SeriesNumber:"",instances:[{metadata:{SOPInstanceUID:"",SOPClassUID:"1.2.840.10008.5.1.4.1.1.104.1",Rows:"",Columns:"",NumberOfFrames:0,InstanceNumber:1},getImageId:function(){return e},isLocalFile:!0}]}]}}}])&&u(n.prototype,r),o&&u(n,o),t}(a)),d=n(27);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=n(16).a.cornerstone.metadataProvider,S=new(function(e){function t(){var e,n,r,i,o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var u=arguments.length,c=new Array(u),l=0;l<u;l++)c[l]=arguments[l];return r=this,n=!(i=(e=v(t)).call.apply(e,[this].concat(c)))||"object"!==y(i)&&"function"!=typeof i?h(r):i,o=h(n),s="application/dicom",(a="fileType")in o?Object.defineProperty(o,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[a]=s,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,e),n=t,(r=[{key:"loadFile",value:function(e,t){return i.a.wadouri.loadFileRequest(t)}},{key:"getDataset",value:function(e,t){var n={};try{var r=d.a.data.DicomMessage.readFile(e);n=d.a.data.DicomMetaDictionary.naturalizeDataset(r.dict),g.addInstance(n),n._meta=d.a.data.DicomMetaDictionary.namifyDataset(r.meta)}catch(e){console.error("Error reading dicom file",e)}return n.imageId=t,n}},{key:"getStudies",value:function(e,t){return this.getStudyFromDataset(e)}},{key:"getStudyFromDataset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.StudyInstanceUID,n=e.StudyDate,r=e.StudyTime,i=e.AccessionNumber,o=e.ReferringPhysicianName,a=e.PatientName,s=e.PatientID,u=e.PatientBirthDate,c=e.PatientSex,l=e.StudyID,p=e.StudyDescription,f=e.SeriesInstanceUID,d=e.SeriesDescription,y=e.SeriesNumber,m=e.imageId,v={metadata:e,url:m},h={SeriesInstanceUID:f,SeriesDescription:d,SeriesNumber:y,instances:[v]},b={StudyInstanceUID:t,StudyDate:n,StudyTime:r,AccessionNumber:i,ReferringPhysicianName:o,PatientName:a,PatientID:s,PatientBirthDate:u,PatientSex:c,StudyID:l,StudyDescription:p,series:[h]};return b}}])&&m(n.prototype,r),o&&m(n,o),t}(a));function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=function(e){function t(e){var n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(i=P(t).call(this))||"object"!==w(i)&&"function"!=typeof i?E(r):i,x(E(n),"fileType",void 0),x(E(n),"loader",void 0);var o=e&&e.type;return n.loader=n.getLoader(o),n.fileType=n.loader.fileType,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,e),n=t,o=[{key:"groupSeries",value:function(e){var t=function(e,t,n){var r=1;return e.reduce((function(e,i){var o,a=i[t],s=i[n];return e[a=a||""+r++]||(e[a]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},i),e[a][n]=[]),(o=e[a][n]).push.apply(o,I(s)),e}),{})};return Object.values(t(e,"StudyInstanceUID","series")).map((function(e){var n=t(e.series,"SeriesInstanceUID","instances");return e.series=Object.values(n),e}))}}],(r=[{key:"addFile",value:function(e){return i.a.wadouri.fileManager.add(e)}},{key:"loadFile",value:function(e,t){return this.loader.loadFile(e,t)}},{key:"getDataset",value:function(e,t){return this.loader.getDataset(e,t)}},{key:"getStudies",value:function(e,t){return this.loader.getStudies(e,t)}},{key:"getLoader",value:function(e){return"application/pdf"===e?f:S}}])&&D(n.prototype,r),o&&D(n,o),t}(a);function k(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function R(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){k(o,r,i,a,s,"next",e)}function s(e){k(o,r,i,a,s,"throw",e)}a(void 0)}))}}n.d(t,"a",(function(){return _}));var T=function(){var e=R(regeneratorRuntime.mark((function e(t){var n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new C(t),r=n.addFile(t),e.next=5,n.loadFile(t,r);case 5:return i=e.sent,e.next=8,n.getDataset(i,r);case 8:return o=e.sent,e.next=11,n.getStudies(o,r);case 11:return a=e.sent,e.abrupt("return",a);case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0.name,":Error when trying to load and process local files:",e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}();function _(e){return U.apply(this,arguments)}function U(){return(U=R(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(T),e.next=3,Promise.all(n);case 3:return r=e.sent,e.abrupt("return",C.groupSeries(r.flat()));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},999:function(e,t){}}]);
//# sourceMappingURL=ViewerLocalFileData.bundle.d4642baaf31ae14e153b.js.map